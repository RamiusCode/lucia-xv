<!-- Padres.astro -->

<section class="py-4 relative">
  <div class="max-w-5xl mx-auto relative">
    <!-- Adorno izquierdo -->
    <div class="absolute left-0 top-0 w-12 md:w-20 lg:w-28 pointer-events-none" id="adorno-izq">
      <img src="/imagenes/FloresIzquierda.webp" alt="Adorno floral" class="w-12 h-full object-contain object-left" />
    </div>

    <!-- Contenido central -->
    <div class="max-w-xl mx-auto text-center relative z-10 px-16 md:px-24 lg:px-32">
      <!-- SECCI√ìN 1: MI MAM√Å -->
      <div id="seccion-mama">
        <h2 class="font-charm text-2xl text-[#a27735] font-bold mb-1">
          MI MAM√Å
        </h2>
        <div class="space-y-2">
          <p class="font-charm text-2xl text-[#95303a]">Lorena Vaca Tini</p>
        </div>
      </div>

      <!-- SECCI√ìN 2: MI HERMANO -->
      <div id="seccion-hermano" class="pt-4">
        <h2 class="font-charm text-2xl text-[#a27735] font-bold mb-1">
          MI HERMANO
        </h2>
        <div class="space-y-2">
          <p class="font-charm text-2xl text-[#95303a]">Andr√©s Aramayo Vaca</p>
        </div>
      </div>

      <!-- SECCI√ìN 3: MIS MADRINAS -->
      <div id="seccion-madrinas" class="pt-4">
        <h2 class="font-charm text-2xl text-[#a27735] font-bold mb-1">
          MIS MADRINAS
        </h2>
        <div>
          <p class="font-charm text-2xl text-[#95303a]">Ana Mar√≠a Vaca</p>
          <p class="font-charm text-2xl text-[#95303a]">Sonia Vaca</p>
        </div>
      </div>
    </div>

    <!-- Adorno derecho -->
    <div class="absolute right-0 top-0 w-12 md:w-20 lg:w-28 pointer-events-none" id="adorno-der">
      <img src="/imagenes/FloresDerecha.webp" alt="Adorno floral" class="w-12 h-full object-contain object-right" />
    </div>
  </div>
</section>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  if (typeof window !== 'undefined') {
    document.addEventListener("DOMContentLoaded", () => {
      console.log("üë®‚Äçüë©‚Äçüëß Iniciando animaciones de familia...");

      // üéØ ESTADO INICIAL - Todo oculto
      gsap.set("#seccion-mama", { opacity: 0, y: 30 });
      gsap.set("#seccion-hermano", { opacity: 0, y: 30 });
      gsap.set("#seccion-madrinas", { opacity: 0, y: 30 });
      gsap.set("#adorno-izq", { opacity: 0, x: -30 });
      gsap.set("#adorno-der", { opacity: 0, x: 30 });

      // üìç SCROLLTRIGGER PARA ACTIVAR LA SECUENCIA
      ScrollTrigger.create({
        trigger: "#seccion-mama",
        start: "top 90%", // ‚ö° Aparece r√°pido
        end: "top 20%",
        
        onEnter: () => {
          console.log("‚ú® Iniciando secuencia de familia...");
          animarSecuencia();
        },
        
        onLeaveBack: () => {
          console.log("üëã Ocultando secci√≥n familia...");
          ocultarSecuencia();
        },
      });

      // üé¨ ANIMACI√ìN EN SECUENCIA
      function animarSecuencia() {
        const tl = gsap.timeline();

        // 1Ô∏è‚É£ Primero los adornos
        tl.to("#adorno-izq", {
          opacity: 1,
          x: 0,
          duration: 0.6,
          ease: "power2.out",
        })
        .to("#adorno-der", {
          opacity: 1,
          x: 0,
          duration: 0.6,
          ease: "power2.out",
        }, "-=0.5")

        // 2Ô∏è‚É£ Luego MI MAM√Å (t√≠tulo + nombre juntos)
        .to("#seccion-mama", {
          opacity: 1,
          y: 0,
          duration: 0.8,
          ease: "power2.out",
        }, "-=0.3")

        // 3Ô∏è‚É£ Despu√©s MI HERMANO (t√≠tulo + nombre juntos)
        .to("#seccion-hermano", {
          opacity: 1,
          y: 0,
          duration: 0.8,
          ease: "power2.out",
        }, "-=0.4") // Se solapa un poco con la anterior

        // 4Ô∏è‚É£ Finalmente MIS MADRINAS (t√≠tulo + nombres juntos)
        .to("#seccion-madrinas", {
          opacity: 1,
          y: 0,
          duration: 0.8,
          ease: "power2.out",
        }, "-=0.4");
      }

      // üîô ANIMACI√ìN DE SALIDA (cuando sube el scroll)
      function ocultarSecuencia() {
        const tl = gsap.timeline();

        tl.to("#seccion-madrinas", {
          opacity: 0,
          y: 30,
          duration: 0.4,
          ease: "power2.in",
        })
        .to("#seccion-hermano", {
          opacity: 0,
          y: 30,
          duration: 0.4,
          ease: "power2.in",
        }, "-=0.3")
        .to("#seccion-mama", {
          opacity: 0,
          y: 30,
          duration: 0.4,
          ease: "power2.in",
        }, "-=0.3")
        .to("#adorno-der", {
          opacity: 0,
          x: 30,
          duration: 0.4,
          ease: "power2.in",
        }, "-=0.3")
        .to("#adorno-izq", {
          opacity: 0,
          x: -30,
          duration: 0.4,
          ease: "power2.in",
        }, "-=0.3");
      }
    });
  }
</script>